/*
For each possible exit (a . on the edge of the map)
I try to find the shortest path there from @ using A* pathfinding
I sort the possible exits on distance needed, and then for each exit
each fire also uses A* to that exit. If any fire has a shorter distance,
that exit cannot be reached. If not, it can.
 */

function print(input) {
    console.log(input);
}

var readCount = 0;


var input = [
'6',
'4 3',
'####',
'#*@.',
'####',
'7 6',
'###.###',
'#*#.#*#',
'#.....#',
'#.....#',
'#..@..#',
'#######',
'7 4',
'###.###',
'#....*#',
'#@....#',
'.######',
'5 5',
'.....',
'.***.',
'.*@*.',
'.***.',
'.....',
'3 3',
'###',
'#@#',
'###',
'350 500',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************...@..............................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',
'******************************************************************************************..................................................................................................................................................................................................................',

];


function readline() {
    return input[readCount++];
}


function fire() {
    var start = new Date();
    var nrOfGames = parseInt(readline());
    for (var i = 0; i < nrOfGames; i++) {
        solveForBoard(readBoard());
    }
    var end = new Date();
    print('time:');
    print(end - start);
}

function solveForBoard(data) {
    var reachableExits = [];

    for (var i = 0; i < data.exits.length; i++) {
        var distance = findDistanceFromTo(data.start, data.exits[i], data.board);
        if (distance == 0) {
            print('1');
            return;
        }
        if (distance > 0) {
            reachableExits.push({
                x: data.exits[i].x,
                y: data.exits[i].y,
                distance: distance,
                reachable: true
            });
        }
    }

    reachableExits.sort(function (a, b) {
        return a.distance - b.distance;
    });

    for (var j = 0; j < reachableExits.length; j++) {
        var exit = reachableExits[j];

        for (var k = 0; k < data.fires.length; k++) {
            var fireDistance = findDistanceFromTo(data.fires[k], exit, data.board);
            if (fireDistance != -1 && fireDistance < exit.distance) {
                exit.reachable = false;
                break;
            }
        }
        if (exit.reachable) {
            print(exit.distance + 1);
            return;
        }
    }

    print('IMPOSSIBLE');

}

function findDistanceFromTo(from, to, board) {
    var seen = {};
    var open = [];

    // A*
    var startNode = {
        x: from.x,
        y: from.y,
        g: 0
    };
    startNode.h = heuristic(startNode, to);
    startNode.f = startNode.g + startNode.h;


    open.push(startNode);

    while (true) {
        if (open.length == 0) {
            return -1; // fant ingen vei dit
        }

        var pos = open.shift();
        //closed.push(pos);

        if (pos.x == to.x && pos.y == to.y) {
            return pos.g; // found solution
        }

        var options = neighbors(pos, board);

        for (var i = 0; i < options.length; i++) {
            var optionPos = options[i];

            if (!seen[optionPos.x + '-' + optionPos.y]) {
                seen[optionPos.x + '-' + optionPos.y] = true;

            //if (!isPosInList(open, optionPos) && !isPosInList(closed, optionPos)) {
                optionPos.h = heuristic(optionPos, to);
                optionPos.f = optionPos.g + optionPos.h;
                addPosToList(open, optionPos);
            }
        }
    }

}

function isPosInList(list, pos) {
    return list.some(function (el) {
        return el.x == pos.x && el.y == pos.y;
    });
}

function addPosToList(list, pos) {
    // sortert på f
    for (var i = 0; i < list.length; i++) {
        if (pos.f <= list[i].f) {
            list.splice(i, 0, pos);
            return;
        }
    }

    list.push(pos);
}

function heuristic(from, to) {
    // Manhattan
    return Math.abs(from.x - to.x) + Math.abs((from.y - to.y));
}

function neighbors(pos, board) {
    var children = [];
    var g = pos.g;
    // right
    if (pos.x + 1 <= board.maxX && board.data[pos.y][pos.x + 1] == '.') {
        children.push({
            g: g + 1,
            x: pos.x + 1,
            y: pos.y
        });
    }
    // left
    if (pos.x - 1 >= 0 && board.data[pos.y][pos.x - 1] == '.') {
        children.push({
            g: g + 1,
            x: pos.x - 1,
            y: pos.y
        });
    }
    // up
    if (pos.y - 1 >= 0 && board.data[pos.y - 1][pos.x] == '.') {
        children.push({
            g: g + 1,
            x: pos.x,
            y: pos.y - 1
        });
    }
    // up
    if (pos.y + 1 <= board.maxY && board.data[pos.y + 1][pos.x] == '.') {
        children.push({
            g: g + 1,
            x: pos.x,
            y: pos.y + 1
        });
    }

    return children;
}

function readBoard() {
    var sizes = readline().split(' ');

    var exits = [];
    var board = [];
    var fires = [];
    var startPos;

    for (var i = 0; i < sizes[1]; i++) {
        var line = readline().split('');
        board.push(line);

        for (var k = 0; k < line.length; k++) {
            if (line[k] == '@') {
                line[k] = '.';
                startPos = {x: k, y: i};
            } else if (line[k] == '*') {
                fires.push({x: k, y: i});
            }
        }

        if (i == 0 || i == sizes[1] - 1) {
            for (var j = 0; j < line.length; j++) {
                if (line[j] == '.') {
                    exits.push({x: j, y: i});
                }
            }
        } else {
            if (line[0] == '.') {
                exits.push({x: 0, y: i});
            }
            if (line[sizes[0] - 1] == '.') {
                exits.push({x: sizes[0] - 1, y: i});
            }

        }
    }

    return {
        board: {
            maxX: sizes[0] - 1,
            maxY: sizes[1] - 1,
            data: board
        },
        exits: exits,
        fires: fires,
        start: startPos
    }
}

fire();
